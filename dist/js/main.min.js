const mainElement=document.querySelector(".main"),headerElement=document.querySelector(".header"),quizMenu=mainElement.querySelector(".quiz-menu"),quizMain=mainElement.querySelector(".quiz-main"),quizEnd=mainElement.querySelector(".quiz-end"),menuOptionList=quizMenu.querySelector(".option-list"),answerOptionList=quizMain.querySelector(".option-list"),menuOptions=Array.from(menuOptionList.children),answerOptions=Array.from(answerOptionList.children),submitButton=quizMain.querySelector("#submit-button"),playAgainButton=quizEnd.querySelector("#play-again-button"),srOnlyResultElement=quizMain.querySelector("#selection-result");let newQuiz,quizzes={};function Quiz(e){this.currentQuizData={},this.quizScore=0,this.quizProgressValue=0,this.quizTopic=e,this.startQuizAbout=()=>{if(this.currentQuizData=quizzes.find((e=>e.title===this.quizTopic)),!this.currentQuizData)throw new Error(`No quiz found with the title ${this.quizTopic}`);this.quizScore=0,this.quizProgressValue=0,switchQuizFrame("main"),renderQuizDetails("main")},this.getQuizDetails=e=>{const t=this.currentQuizData.questions,i=t[this.quizProgressValue],{question:n,options:o,answer:r}=i,u={question:n,options:o,answer:r,"quiz-length":t.length};if(e in u==!1)throw new Error(`No such detail available: ${e}`);return u[e]},this.getTopicIcon=()=>this.currentQuizData.icon}function switchQuizFrame(e){const t=mainElement.querySelector({menu:".quiz-menu",main:".quiz-main",end:".quiz-end"}[e]);Array.from(mainElement.children).forEach((e=>{e.classList.toggle("none",e!==t)}))}function updateQuizTopicIndificators(){document.querySelectorAll(".quiz-topic").forEach((e=>{const t=e.querySelector("img"),i=e.querySelector("span");t.src=newQuiz.getTopicIcon(),t.setAttribute("data-icon",newQuiz.quizTopic.toLowerCase()),i.textContent=newQuiz.quizTopic}))}function updateProgressIndicators(){const e=mainElement.querySelector("#question-index"),t=mainElement.querySelector("#quiz-progress");e.textContent=newQuiz.quizProgressValue+1,t.value=newQuiz.quizProgressValue+1}function resetOptions(){const e=["data-pick","data-correct-option","data-revealed"];answerOptions.forEach((t=>{const i=t.querySelector("input");i.removeAttribute("disabled"),i.checked&&(i.checked=!1),e.forEach((e=>{t.hasAttribute(e)&&t.removeAttribute(e)}))}))}function renderQuizDetails(e){if(updateProgressIndicators(),resetOptions(),"end"===e){const e=quizEnd.querySelector("#quiz-score"),t=quizEnd.querySelector("#quiz-length");return e.textContent=newQuiz.quizScore,void(t.textContent=newQuiz.getQuizDetails("quiz-length"))}if("main"===e){quizMain.querySelector("#question-text").textContent=newQuiz.getQuizDetails("question"),answerOptions.forEach((e=>{const t=newQuiz.getQuizDetails("options"),i=newQuiz.getQuizDetails("answer"),n=t[answerOptions.indexOf(e)],o=e.querySelector("input[type='radio']");e.querySelector("[data-option-text]").textContent=n,o.ariaLabel=`answer option: ${n}`,n===i&&e.setAttribute("data-correct-option","")}))}}function isQuizCompleated(){const e=newQuiz.getQuizDetails("quiz-length");return newQuiz.quizProgressValue+1===e}function revealOptionStatus(e,t,i){e.setAttribute("data-revealed","");const n=t?"dist/img/icon-correct.svg":"dist/img/icon-incorrect.svg";e.querySelector(".option__status-indicator").src=n,i&&(e.dataset.pick=t?"correct":"incorrect")}fetch("/data.json").then((e=>{if(e.ok)return e.json();throw new Error("response was not received")})).then((e=>{quizzes=e.quizzes})).catch((e=>{console.error(e)})),menuOptions.forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault();const t=e.currentTarget.getAttribute("data-option-topic");newQuiz=new Quiz(t),newQuiz.startQuizAbout(),updateQuizTopicIndificators()}))})),submitButton.addEventListener("click",(e=>{const t=answerOptionList.querySelector("input:checked"),i=isQuizCompleated();if(!t){return void quizMain.querySelector("#error-message").classList.toggle("hidden",t)}if("next"===submitButton.dataset.action)return i?(switchQuizFrame("end"),void renderQuizDetails("end")):(newQuiz.quizProgressValue+=1,srOnlyResultElement.textContent="",submitButton.setAttribute("data-action","submit"),void renderQuizDetails("main"));let n;submitButton.setAttribute("data-action","next"),submitButton.textContent="Next Question";const o=answerOptionList.querySelector("[data-correct-option]");answerOptions.forEach((e=>{const t=e.querySelector("input");t.checked&&(n=e),t.setAttribute("disabled",!0)}));const r=n.hasAttribute("data-correct-option");revealOptionStatus(n,r,!0),r?(newQuiz.quizScore+=1,console.log(newQuiz.quizScore),srOnlyResultElement.textContent="You got correct answer"):(revealOptionStatus(o,!0,!1),srOnlyResultElement.textContent=`You got incorrect answer. Correct option: ${o.querySelector("[data-option-text]").textContent}`)})),playAgainButton.addEventListener("click",(e=>{switchQuizFrame("menu")}));const header=document.querySelector("header"),body=document.querySelector("body"),themeToggle=header.querySelector("#theme-toggle");let darkModeEnabled=JSON.parse(localStorage.getItem("quiz-dark-mode"))||!1;body.classList.toggle("dark-mode",darkModeEnabled),themeToggle.checked=darkModeEnabled;const togglePageTheme=()=>{darkModeEnabled=!darkModeEnabled,localStorage.setItem("quiz-dark-mode",darkModeEnabled),body.classList.toggle("dark-mode",darkModeEnabled)};themeToggle.addEventListener("change",togglePageTheme);